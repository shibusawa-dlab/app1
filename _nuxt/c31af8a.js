(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{465:function(t,e,n){"use strict";n.r(e);n(283);var r=n(21),l=n(31),o=n(26),c=n(22),v=n(7),f=n(154);function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=Object(c.a)(t);if(e){var l=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,l)}else n=r.apply(this,arguments);return Object(o.a)(this,n)}}var d=function(t,e,n,desc){var r,l=arguments.length,o=l<3?e:null===desc?desc=Object.getOwnPropertyDescriptor(e,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(v.a)(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,desc);else for(var i=t.length-1;i>=0;i--)(r=t[i])&&(o=(l<3?r(o):l>3?r(e,n,o):r(e,n))||o);return l>3&&o&&Object.defineProperty(e,n,o),o},m=function(t){Object(l.a)(n,t);var e=h(n);function n(){return Object(r.a)(this,n),e.apply(this,arguments)}return n}(f.Vue);d([Object(f.Prop)({required:!0})],m.prototype,"items",void 0);var y=m=d([f.Component],m),_=n(86),x=n(119),k=n.n(x),$=n(477),C=n(462),j=n(184),O=n(47),component=Object(_.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-sheet",{attrs:{color:"grey lighten-2"}},[n("v-container",{staticClass:"py-2 px-0 mx-0",attrs:{fluid:""}},[n("v-breadcrumbs",{staticClass:"py-0",attrs:{items:t.items},scopedSlots:t._u([{key:"divider",fn:function(){return[n("v-icon",[t._v("mdi-chevron-right")])]},proxy:!0}])})],1)],1)}),[],!1,null,null,null);e.default=component.exports;k()(component,{VBreadcrumbs:$.a,VContainer:C.a,VIcon:j.a,VSheet:O.a})},574:function(t,e,n){var content=n(635);"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(12).default)("697f26b8",content,!0,{sourceMap:!1})},634:function(t,e,n){"use strict";n(574)},635:function(t,e,n){var r=n(11)(!1);r.push([t.i,"mark{background-color:#ffc168}",""]),t.exports=r},6908:function(t,e,n){"use strict";n.r(e);n(53),n(30),n(61),n(87),n(20),n(214),n(59),n(16),n(212),n(24),n(72),n(43),n(74),n(49),n(44),n(56);var r=n(35),l=(n(50),n(9)),o=n(103),c=n.n(o),v=n(465);function f(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,e){if(!t)return;if("string"==typeof t)return h(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(t,e)}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,l=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw l}}}}function h(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}var d=n(633);var m={components:{Breadcrumbs:v.default},data:function(){return{page:1,perPage:24,total:0,items:[],ids:[],q:"",limit:10,aggs:{},facets:{},loading:!0,bh:[{text:this.$t("top"),disabled:!1,to:this.localePath({name:"index"}),exact:!0},{text:this.$t("fulltext_search")}]}},computed:{length:function(){return Math.ceil(this.total/this.perPage)},filters:function(){var t=this.$route.query,e=[];for(var n in t)n.includes("refinementList")&&e.push({label:n.split("[")[2].split("]")[0],value:t[n]});return e}},watch:{page:function(t){var e=JSON.parse(JSON.stringify(this.$route.query));1===t?delete e["main[page]"]:e["main[page]"]=t,this.$router.push(this.localePath({name:"search",query:e}))},$route:function(t,e){this.filter(),this.list()}},mounted:function(){var t=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n,r,l,o,v,q;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.a.get("https://shibusawa-dlab.github.io/app1/data/docs.json");case 2:return n=(n=e.sent).data,t.docs=n,e.next=7,c.a.get("https://shibusawa-dlab.github.io/app1/data/index.json");case 7:return r=(r=e.sent).data,t.index=r,e.next=12,c.a.get("https://shibusawa-dlab.github.io/app1/data/facets.json");case 12:l=(l=e.sent).data,t.facets=l,o=t.$route.query,v=Number(o["main[page]"])||1,t.page=v,q=o["main[query]"]||"",t.q=q,t.filter(),t.list(),t.loading=!1;case 23:case"end":return e.stop()}}),e)})))()},methods:{init:function(){var t=JSON.parse(JSON.stringify(this.$route.query));for(var e in t)e.includes("refinementList")&&delete t[e];delete t["main[page]"],this.$router.push(this.localePath({name:"search",query:t}))},filter:function(){var t=JSON.parse(JSON.stringify(this.$route.query)),q=t["main[query]"]||"",e=this.docs,n=this.index,l=[];if(""===q)l=Object.keys(e);else{var o,c=q.split("　").join(" ").split(" "),v=Object.keys(e),h=f(c);try{var m=function(){var t,e=o.value,l=[],c=f(Object.keys(n).filter((function(t){return t.match(e)})));try{for(c.s();!(t=c.n()).done;){var h=t.value;l.push.apply(l,Object(r.a)(n[h]))}}catch(t){c.e(t)}finally{c.f()}v=d.intersection(v,l)};for(h.s();!(o=h.n()).done;)m()}catch(t){h.e(t)}finally{h.f()}l=v}var y=this.facets;for(var _ in t)if(_.includes("refinementList")){var x=_.split("[")[2].split("]")[0],k=t[_];"string"==typeof k&&(k=[k]);var $,C=f(k);try{for(C.s();!($=C.n()).done;){var j=$.value,O=y[x][j];l=d.intersection(l,O)}}catch(t){C.e(t)}finally{C.f()}}this.total=l.length,this.ids=l.sort(),this.getAggs()},getAggs:function(){var t,e={category_lvl0:{sort:"name:asc",label:this.$t("category_lvl0"),value:{},more:!1},category_lvl1:{sort:"name:asc",label:this.$t("category_lvl1"),value:{},more:!1},date_lvl0:{sort:"name:asc",label:this.$t("year"),value:{},more:!1},date_lvl1:{sort:"name:asc",label:this.$t("yearAndMonth"),value:{},more:!1},date_lvl2:{sort:"name:asc",label:this.$t("date"),value:{},more:!1},agential:{sort:"",label:this.$t("agential"),value:{},more:!1},spatial:{sort:"",label:this.$t("spatial"),value:{},more:!1},type:{sort:"",label:this.$t("type"),value:{},more:!1}},n=this.docs,r=f(this.ids);try{for(r.s();!(t=r.n()).done;){var l=n[t.value];for(var o in e){var c=e[o].value,v=l[o];if("string"==typeof v&&(v=[v]),v){var h,d=f(v);try{for(d.s();!(h=d.n()).done;){var m=h.value;c[m]||(c[m]=0),c[m]+=1}}catch(t){d.e(t)}finally{d.f()}}}}}catch(t){r.e(t)}finally{r.f()}for(var y in e){var _=e[y];if("name:asc"!==_.sort){(w=Object.entries(_.value)).sort((function(t,e){return-(t[1]-e[1])}))}else{var x=_.value,k=Object.keys(x);k.sort();for(var $={},C=0,j=k;C<j.length;C++){var O=j[C];$[O]=x[O]}var w=Object.entries($)}var S=w.slice(0,50);e[y].value=S}this.aggs=e},search:function(){var t=JSON.parse(JSON.stringify(this.$route.query)),q=this.q||"";""===(q=q.trim())?delete t["main[query]"]:t["main[query]"]=q,delete t["main[page]"],this.page=1,this.$router.push(this.localePath({name:"search",query:t}))},list:function(){var t,e=this.$route.query["main[page]"]||1,n=[],r=f(this.ids.slice((e-1)*this.perPage,e*this.perPage));try{for(r.s();!(t=r.n()).done;){var l=t.value;n.push(this.docs[l])}}catch(t){r.e(t)}finally{r.f()}this.items=n},faceted:function(t,e){var n=JSON.parse(JSON.stringify(this.$route.query)),r=[];for(var l in n)l.includes("["+t+"]")&&(r.push(n[l]),delete n[l]);r.includes(e)?r=r.filter((function(t){return t!=e})):r.push(e);for(var i=0;i<r.length;i++)n["main[refinementList]["+t+"]["+i+"]"]=r[i];this.$router.push(this.localePath({name:"search",query:n}))},checked:function(t,e){var n=this.$route.query,r=[];for(var l in n)l.includes("["+t+"]")&&r.push(n[l]);return!!r.includes(e)},highlightRelation:function(t,e){var n,r=[],l=f(e.split("　").join(" ").split(" "));try{for(l.s();!(n=l.n()).done;){var o=n.value;o&&!r.includes(o)&&r.push(o)}}catch(t){l.e(t)}finally{l.f()}var c,v=f(this.filters);try{for(v.s();!(c=v.n()).done;){var label=c.value.value;r.includes(label)||r.push(label)}}catch(t){v.e(t)}finally{v.f()}t=String(t).replace(/<[^>]*>?/gm,"");var h,d=f(r.sort((function(a,b){return b.length-a.length})));try{for(d.s();!(h=d.n()).done;){var m=h.value;try{var y=new RegExp(m,"g");t=t.replace(y,(function(t){return'<span style="font-weight: bold; background-color: #FFF59D;">'+t+"</span>"}))}catch(t){console.log({e:t})}}}catch(t){d.e(t)}finally{d.f()}return t},convert:function(t){var e=document.createElement("div");return e.innerHTML=t,t=(t=e.textContent).split("\n").join("")}},head:function(){return{title:this.$t("fulltext_search")}}},y=(n(634),n(86)),_=n(119),x=n.n(_),k=n(206),$=n(468),C=n(515),j=n(483),O=n(462),w=n(6884),S=n(6885),P=n(6886),V=n(6887),R=n(184),J=n(638),N=n(180),E=n(484),A=n(6875),component=Object(y.a)(m,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("Breadcrumbs",{attrs:{items:t.bh}}),t._v(" "),n("v-container",{staticClass:"my-5"},[n("h2",[t._v(t._s(t.$t("fulltext_search")))]),t._v(" "),n("p",{staticClass:"my-2"},[t._v("\n      『渋沢栄一伝記資料』別巻第1,\n      第2の本文を対象に検索します。検索するとその結果がハイライトされますが、ファセット・ナビゲーションを利用した際には機能しない場合があります。\n    ")]),t._v(" "),t.loading?[n("div",{staticClass:"text-center"},[n("v-progress-circular",{staticClass:"my-10",attrs:{indeterminate:"",color:"primary"}}),t._v(" "),n("p",[t._v("\n          初回はインデックスファイルのダウンロードに時間を要します。2回目以降はキャッシュにより待ち時間が改善します。\n        ")])],1)]:[n("v-row",{staticClass:"mt-2",attrs:{dense:""}},[n("v-col",{attrs:{cols:"12",md:"12"}},[n("v-text-field",{attrs:{"background-color":"grey lighten-3",filled:"",rounded:"",dense:"",placeholder:t.$t("add_a_search_term"),"append-icon":"mdi-magnify",clearable:"","clear-icon":"mdi-close-circle"},on:{"click:append":function(e){return t.search(t.q,e)},keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(t.q,e)}},model:{value:t.q,callback:function(e){t.q=e},expression:"q"}})],1)],1),t._v(" "),t.filters.length>0?n("div",[t._l(t.filters,(function(filter,e){return n("v-chip",{key:e,staticClass:"mr-2 my-2",attrs:{close:"",dark:""},on:{"click:close":function(e){return t.faceted(filter.label,filter.value)}}},[t._v("\n          "+t._s(t.aggs[filter.label].label)+": "+t._s(filter.value)+"\n        ")])})),t._v(" "),t.filters.length>0?n("v-btn",{staticClass:"mr-2 my-2",attrs:{text:"",color:"primary"},on:{click:function(e){return t.init()}}},[t._v("\n          "+t._s(t.$t("Clear all"))+"\n        ")]):t._e()],2):t._e(),t._v(" "),n("v-row",{staticClass:"mt-5",attrs:{dense:""}},[n("v-col",{attrs:{cols:"12",sm:"6"}},[n("h3",{staticClass:"my-0"},[t._v("\n            "+t._s(t.$t("search_result"))+": "+t._s(t.total.toLocaleString())+"\n            "+t._s(t.$t("hits"))+"\n          ")])]),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"4"}}),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"2"}}),t._v(" "),n("v-col",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{cols:"12",sm:"2"}})],1),t._v(" "),n("div",{staticClass:"text-center mt-5"},[n("v-pagination",{attrs:{length:t.length,"total-visible":7},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1),t._v(" "),n("v-row",{staticClass:"mt-5"},[n("v-col",{attrs:{cols:"12",sm:"8","order-sm":"12"}},[n("v-row",t._l(t.items,(function(e){return n("v-col",{key:e.objectID,attrs:{cols:"12"}},[n("v-card",{attrs:{flat:"",outlined:""}},[n("div",{staticClass:"pa-4"},[n("nuxt-link",{attrs:{to:t.localePath({name:"item-id",params:{id:e.objectID}})}},[n("h3",[t._v(t._s(e.label))])]),t._v(" "),n("div",{staticClass:"my-2"},[e.category?n("p",[n("small",[t._v("\n                        "+t._s(e.category.lvl1)+"\n                      ")])]):t._e(),t._v(" "),n("small",[n("span",{staticClass:"mr-4"},[n("b",[t._v("ID:")]),t._v("\n                        "+t._s(e.objectID)+"\n                      ")]),t._v(" "),n("span",{staticClass:"mr-4"},[n("b",[t._v(t._s(t.$t("date"))+":")]),t._v(" "),t._v("\n                        "+t._s(t.$utils.wareki(e.temporal)))]),t._v(" "),e.agential&&e.agential.length>0?n("span",{staticClass:"mr-4"},[n("b",[t._v(t._s(t.$t("agential"))+":")]),t._v("\n                        "+t._s(e.agential.join(", "))+"\n                      ")]):t._e(),t._v(" "),e.spatial&&e.spatial.length>0?n("span",[n("b",[t._v(t._s(t.$t("spatial"))+":")]),t._v("\n                        "+t._s(e.spatial.join(", "))+"\n                      ")]):t._e()])]),t._v(" "),e.xml?n("p",{staticClass:"mt-4",staticStyle:{"max-height":"200px","overflow-y":"auto"},domProps:{innerHTML:t._s(t.highlightRelation(t.convert(e.xml),t.q))}}):t._e()],1)])],1)})),1)],1),t._v(" "),n("v-col",{attrs:{cols:"12",sm:"4","order-sm":"1"}},t._l(t.aggs,(function(e,r){return n("v-expansion-panels",{key:r,staticClass:"mb-4",attrs:{value:0,flat:""}},[n("v-expansion-panel",[n("v-expansion-panel-header",{staticClass:"grey lighten-2"},[n("h3",[t._v(t._s(e.label))])]),t._v(" "),n("v-expansion-panel-content",{staticClass:"py-2",attrs:{outlined:""}},[t._l(e.value,(function(l,o){return[o<t.limit||e.more?n("div",{key:o,staticClass:"mt-1",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.faceted(r,l[0])}}},[t.checked(r,l[0])?[n("v-icon",{attrs:{color:"primary"}},[t._v(" mdi-checkbox-marked ")])]:[n("v-icon",[t._v(" mdi-checkbox-blank-outline ")])],t._v("\n                    "+t._s(l[0])+"\n                    "),n("v-chip",{attrs:{small:""}},[t._v("\n                      "+t._s(l[1])+"\n                    ")])],2):t._e()]})),t._v(" "),e.value.length>=t.limit?n("v-btn",{staticClass:"mt-4",attrs:{color:"primary",small:"",rounded:"",depressed:""},on:{click:function(t){e.more=!e.more}}},[t._v(t._s(t.$t(e.more?"Show less":"Show more")))]):t._e()],2)],1)],1)})),1)],1),t._v(" "),n("div",{staticClass:"text-center mt-10"},[n("v-pagination",{attrs:{length:t.length,"total-visible":7},model:{value:t.page,callback:function(e){t.page=e},expression:"page"}})],1)]],2)],1)}),[],!1,null,null,null);e.default=component.exports;x()(component,{VBtn:k.a,VCard:$.a,VChip:C.a,VCol:j.a,VContainer:O.a,VExpansionPanel:w.a,VExpansionPanelContent:S.a,VExpansionPanelHeader:P.a,VExpansionPanels:V.a,VIcon:R.a,VPagination:J.a,VProgressCircular:N.a,VRow:E.a,VTextField:A.a})}}]);